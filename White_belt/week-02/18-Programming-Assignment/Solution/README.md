Решение этой задачи очень похоже на решение задачи «Автобусные остановки — 2». Разница лишь в том, что набор остановок теперь представляет собой не вектор, а множество строк.